fn make_map(input: &str) -> Vec<Vec<bool>> {
    input
        .lines()
        .map(|line| {
            line.chars()
                .map(|c| match c {
                    '.' => false,
                    '#' => true,
                    _ => unreachable!(),
                })
                .collect()
        })
        .collect()
}

fn traverse(map: &Vec<Vec<bool>>, h_inc: usize, w_inc: usize) -> usize {
    let height = map.len();
    let width = map[0].len();

    let mut coords = (0, 0);
    let mut trees = 0;
    while coords.0 < height {
        if map[coords.0][coords.1] {
            trees += 1;
        }
        coords = (coords.0 + h_inc, (coords.1 + w_inc) % width);
    }
    trees
}

pub fn pt1(input: &str) -> usize {
    let map = make_map(input);
    traverse(&map, 1, 3)
}

pub fn pt2(input: &str) -> usize {
    let map = make_map(input);
    let n1 = traverse(&map, 1, 1);
    let n2 = traverse(&map, 1, 3);
    let n3 = traverse(&map, 1, 5);
    let n4 = traverse(&map, 1, 7);
    let n5 = traverse(&map, 2, 1);
    n1 * n2 * n3 * n4 * n5
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn day3() {
        let input = "\
..##.......\n\
#...#...#..\n\
.#....#..#.\n\
..#.#...#.#\n\
.#...##..#.\n\
..#.##.....\n\
.#.#.#....#\n\
.#........#\n\
#.##...#...\n\
#...##....#\n\
.#..#...#.#\n\
            ";
        assert_eq!(pt1(&input), 7);
        assert_eq!(pt2(&input), 336);
    }
}

pub static INPUT: &str = "\
............#....#.............\n\
...........##....#......#..#..#\n\
......#.......#......#.........\n\
..#.#....#....#.............##.\n\
..#........####....#...#.......\n\
..##.....#.#.#..#.........#....\n\
...#.#..#..#....#..#..#........\n\
#.......#.........#....##.###..\n\
......##..#.#...#.......#.#....\n\
................##.........#.##\n\
..##..........#...#.........#.#\n\
..........#...##...............\n\
#...#......#..#.#..#...##..#...\n\
..##....#.......#......#..#....\n\
....#......#......#....#.......\n\
.........#.....#..#............\n\
.#...#.#.........#........#....\n\
#..........####.....#..........\n\
......##.....#....#..#........#\n\
#......#......#...........#....\n\
....#.........#....#...#..#..#.\n\
.#........#......#.#.....#.....\n\
..#.#.#..........#....#.......#\n\
......#.#........##....##....##\n\
.....#.#..#...#................\n\
......#......##...............#\n\
..#..##.............#...##.....\n\
......##......##..#......#.....\n\
....#.............#..##.....##.\n\
........#...............##.....\n\
..#......#.##..#...#....#...#..\n\
#......#.......#.............#.\n\
.....#....##..............#....\n\
#.#.........#....#..##....#....\n\
.#...#...#....#.#............#.\n\
...#...#.#..##.##.......##.....\n\
......#..#....##..#.#..#..#....\n\
.......##..#..#......#..#.....#\n\
.##..#......#..........#....#..\n\
.....#................#..#....#\n\
........#..#....#.......#....#.\n\
..#......#.......#......#....#.\n\
....#...#.##........##....#....\n\
.....#........#...........#....\n\
...#....##..........#..#...#.#.\n\
...#.......#......#...##...#...\n\
.#.....#........#........#.#..#\n\
.#.........#..##.....#.......#.\n\
....#..#....#.......#......#...\n\
.#.#...##..##................##\n\
......#.#...#.......#....#....#\n\
........#....#..#.....#......#.\n\
.......#..........#......#.....\n\
...............................\n\
..#..#####..#..#..........#.#..\n\
.....#....##................#.#\n\
.................##............\n\
.#...#...#..#...........#...##.\n\
..#..#.#...........#.....##....\n\
.#.......#.....#..##..#.#....#.\n\
..........#.#......##...##.....\n\
........##..#......##...#......\n\
#......................#.......\n\
............#.....#....#.#...#.\n\
#......#..........##..#........\n\
.........#.......#...#.#.......\n\
...........##....#........#....\n\
#........#.....#...#........##.\n\
.#......##......#.##.......#..#\n\
.....#......#.#......#.......#.\n\
.....#.#.........#.............\n\
...........#..#....#.....#.#...\n\
...#............#...#..........\n\
..#..#...#.....................\n\
......#..#...#....#............\n\
.#.#.#........#..#...#.........\n\
..........#........#..#........\n\
..............#...#....#.......\n\
..#....#....##.......#...#.##..\n\
.#.........#...#......#........\n\
..#......#...#.........##.#...#\n\
...#.....#...#..#.............#\n\
.##........#.#.#.............#.\n\
..#.............#..#.#...#....#\n\
#...#.........#......#......#..\n\
.......##..#.#..........#...#..\n\
.......#.............#..#.#....\n\
.#..#....#.#...................\n\
....##...#..#....#..#..........\n\
....#.#............#...........\n\
###........##..#.#..#..........\n\
.#.#.#.......#...........#..#.#\n\
..........##..#.............#..\n\
.#...........#......#.#..#..##.\n\
...###......#.##........#.....#\n\
....#..#..#...#................\n\
...#.....#........#............\n\
....#...#...#..#..##.##.......#\n\
#.......#......#....#.......#..\n\
#.............#...#............\n\
##......#..#...#....##.#...#...\n\
.##....................#....#..\n\
..#.....#....#.#....#......#...\n\
.......#..#..#............#...#\n\
.#.....#.......#..#..#..#......\n\
......##.......................\n\
#..#...#.#.#....#.....#..#.....\n\
...................#...#...#...\n\
........#....##..#....#........\n\
##......#.#......##.###........\n\
.........#...##................\n\
.......#...#...#.......##......\n\
....#.......#......#.........##\n\
....#....#.#..#.....#..........\n\
...........#.......#........#..\n\
..#.........###.#........#.....\n\
.......#...........#.#.....##..\n\
..#...#..#..........#..........\n\
..........#.#....#.............\n\
.##....#........##.............\n\
.............#.#####........#.#\n\
.................##...#........\n\
##...#.#.......##........#.....\n\
.#...#...#..#..#....#....#.....\n\
..#...#........#..#............\n\
##...#.#........#......##.#..##\n\
.##......#..............##.#..#\n\
.........#...#............#...#\n\
....#..#....#...........#......\n\
........#..#....#...##...#.....\n\
..#..............#...#.#.....#.\n\
.#.......#.#.....#..###.......#\n\
...................#.......#...\n\
........##.....#..#.......##...\n\
.....#....................#...#\n\
...#.#....#............#.#.....\n\
#.......#.......#....#.........\n\
..#...............#............\n\
##...#...#...#..............#..\n\
...#..........#..#....##.......\n\
#............##.##......#.#.#..\n\
.#...........#.........#....##.\n\
..##....##.#....#.#.#.##...##.#\n\
........#.#.#.............#....\n\
.#...........#....##...#...#.#.\n\
.##...#.................#......\n\
....#.#..#....................#\n\
.##......#........#..#.........\n\
...#...............#...........\n\
.#.#..##..##.#........#........\n\
...........#....#.#.#......#...\n\
...................#........#.#\n\
..#............#...#.#........#\n\
....#....#.#.##......#...#.....\n\
..................#............\n\
..........................#....\n\
........#......................\n\
......#.#...#.#..##......#.#.#.\n\
.........#...#..#..............\n\
..#.......#..........##..#.....\n\
.........#............#........\n\
......#..#..#...###....#....#..\n\
#..#..............##.###..##..#\n\
.#..................#.....#...#\n\
........#........#........#....\n\
.........#........#.##......#..\n\
..#.....#.#..###...#....#......\n\
..#................##....#.....\n\
..#.#....##.....#......##...#..\n\
...#.......#........##.........\n\
#........#...#.#..........##..#\n\
................#...#.#.....#..\n\
.........#..#..#.#..#.#...#....\n\
##....#...##.........#.#...#.##\n\
....#..#.....##.....#.....##...\n\
................#............#.\n\
..#..#...#.....#......#.....##.\n\
....#.......#...#...#...#..#...\n\
....#..##....#.###.#...#..#....\n\
#..##.....#.....#.##..##...##.#\n\
.............###..........#....\n\
..................#.....###....\n\
..........#....#...#......#....\n\
...#..##.......#......#.#...#..\n\
..#.......................##.#.\n\
..#..#..#....#......#...#...##.\n\
#.............#................\n\
..........#.#.#.........#.#....\n\
.....##..#......##.#...........\n\
.#.#.#.#....#.#...#.....#.#...#\n\
......#.....##..............##.\n\
#..#.......##..##..............\n\
#..#..#................###.....\n\
.....#......#.........#........\n\
#...........#........#.#.......\n\
#........#.#...#....#....###..#\n\
###..#.#...........#.##.....#.#\n\
..#..........#..#............#.\n\
...#....#.......#..#.....###...\n\
.#....#.##.#..###..............\n\
.....#.##.##.......###.##...#.#\n\
..#..##.......###..............\n\
.#.........###..#..............\n\
..................###.....#..#.\n\
#....#....#.........#.....#....\n\
.........#.#..#....#.....#.....\n\
....##.......##.......#.#......\n\
.....#...#.##.....#............\n\
....#.#.#.......#..............\n\
.##..#.#..#.......##...........\n\
....#....##..#.....##.......#.#\n\
.....##....#..#.#........#.....\n\
........#.#.#....#....##...#..#\n\
..#......#.#.#..#.##....#.#.#..\n\
..#...#........#..#..........#.\n\
.........#...................#.\n\
........#.....##..#....#....#..\n\
#..............#..........#....\n\
#........#.#...........#.#.....\n\
..#......................#.#..#\n\
.........#.#.....#.#..........#\n\
......#....#.#.##........#.....\n\
.#....##......##..#...#.......#\n\
..#........#...#.##....#..#.#..\n\
.......#.....#..........#.....#\n\
.........#.#..#.........#....#.\n\
..........#.##.........##..#...\n\
......#.#..#.....#.#..........#\n\
......#.#.#..#..#.#............\n\
...##.#..#..............#....#.\n\
#..........#...................\n\
.#....#..#.#.......#........#..\n\
...#...#......#....#......#....\n\
..#.#.......#.......#.......#.#\n\
...#.#...#........#.....#......\n\
#.......#..#...................\n\
#..#..#.............#..#..#..#.\n\
#.......................#....##\n\
.#.........#....#....#.........\n\
...............#...#..#....#..#\n\
#.....#.#...#.#.....#..........\n\
....##.#..#...#.#....###...#.#.\n\
.................#....#........\n\
####.......##...##.......#.##..\n\
#..#....#....##............#...\n\
..##......#..#........#........\n\
....#..#..........#......#...##\n\
..#.#.............#...........#\n\
#...............#...#.......#.#\n\
#..#.........#.##.#.......#...#\n\
......#.....#.............#...#\n\
......#.##.........##...#......\n\
..#......##.#........#.......#.\n\
#..#.........#.##..............\n\
..#....#...#...#..#.....#.#....\n\
................#.......#......\n\
#.....#..............##....#.##\n\
##.....#...#.#.....#..##...#...\n\
#.#............##..........#..#\n\
..#.##......#..#....#..........\n\
....##.#....#.......##.....#...\n\
......#.#....###...#...........\n\
..................#......#....#\n\
..............##...............\n\
......#..#....#.....#..........\n\
.......#........#...#..........\n\
..#......#......##..#.##..#....\n\
..#.#...#...............#......\n\
....#.#.............#.#......#.\n\
....#.#.....#......#..#.......#\n\
........................#..#...\n\
.................#...........#.\n\
#......#......#.#.#.....##.....\n\
..#....##...#.....##.#.....#..#\n\
....#.........#....#.##.#.#....\n\
..#....###.....................\n\
.....#.#....#......#....##....#\n\
#.......#...#......##.......#..\n\
#....#.........##.....#........\n\
#.....#...........#..#.....#...\n\
.................#.....#..##..#\n\
..#...#......####...##.........\n\
...............................\n\
#........#.....#...............\n\
.#.........#....#.#......##....\n\
...#..........#.........#.#.#.#\n\
......##......#....###........#\n\
.....................#.#.#.....\n\
......#..#..#.......#...#......\n\
...##.#.............#.#.......#\n\
..#.#...#..#....#.....#.....#..\n\
..#..#.....................#..#\n\
........#....#..........#..#...\n\
#.##....#..#.#..#............#.\n\
..............###.............#\n\
.#.#..........#.#....#...#....#\n\
....#..........#.#..#......#...\n\
.........##.#...#..............\n\
..................#.....#.#....\n\
.#....#.......#.##.#.........#.\n\
.##..#...#......#..#...........\n\
.#.........#..........#.#......\n\
#.#......#.#.#.#.......#...#.#.\n\
.......#....#.#......#......#..\n\
...#..#....#.#..#..##...##.....\n\
#.#.#.......#....#.........##..\n\
#..#....#........###....#.#....\n\
....#..#.........#....#...#....\n\
...#.#.#.#..#..##.....#.##.....\n\
.......#.......#...............\n\
#.#.#......##....#.............\n\
...#.##........#.....#...##.#..\n\
...#.#.###..........#.......#..\n\
.....#...#.......#.........#...\n\
............#..#...#..##.......\n\
...#....#..##.##..........#.##.\n\
..................#........#...\n\
....#.##.#.##........#.#.......\n\
.#...........##.....##.......#.\n\
#...#.........#.....##.........\n\
#..#....#.#.........#..........\n\
..#......#.#.#......#.....#..#.\n\
..##......#..............#.....\n\
";
